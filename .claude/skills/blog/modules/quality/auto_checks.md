# 自动化质量检查

使用`tools/check_blog_quality.py`进行自动化检查。

## 使用方法

```bash
python3 tools/check_blog_quality.py <markdown_file>
```

## 检查项目

### 1. Frontmatter完整性

检查是否包含所有必需字段：
- title
- date
- tags
- description
- image
- thumbnail
- author
- lang

**特别检查**：
- [ ] image和thumbnail是否一致
- [ ] 是否使用了empty.jpg
- [ ] date格式是否正确（YYYY-MM-DD）

---

### 2. 文章结构完整性

检查是否包含所有必需章节：
- 本文信息
- 摘要
- 核心结论
- 背景
- 关键科学问题
- 创新点
- 研究内容
- Q&A
- 关键结论与批判性总结

**本文信息检查**：
- [ ] 标题
- [ ] 作者
- [ ] 发表时间
- [ ] 单位
- [ ] 引用格式

---

### 3. 公式格式检查

**🚨 高危错误检测**：
- [ ] 是否有双backslash（`$\\Delta$`）
- [ ] 是否有未使用`\mathrm`的微分符号

---

### 4. 加粗格式检查

- [ ] 是否有加粗包含标点符号
- [ ] 是否有加粗包含百分号（`**24%**`）
- [ ] 是否有加粗包含引号（`**"xxx"**`）
- [ ] 是否有加粗包含括号（`**xxx（yyy）**`）

---

### 5. 中文标点检查

- [ ] 是否有中文后的英文逗号
- [ ] 是否有中文后的英文分号
- [ ] 是否有英文引号（应使用中文引号）

---

### 6. 转义符检查

- [ ] 是否有`\&`（应为`&`）
- [ ] 是否有`1\.`（应为`1.`）

---

### 7. 不规范符号检查

- [ ] 是否有`~700`（应为"约700个"）
- [ ] 是否有`52000+`（应为"52000余个"）
- [ ] 是否有`+30`（应为"30"）

---

### 8. Mermaid语法检查

每个Mermaid图块检查：
- [ ] 是否使用`graph TB`布局
- [ ] 是否包含`---`分隔符（严重错误）
- [ ] 列表格式是否正确（`2.xx`无空格）

---

### 9. 图片和图注检查

- [ ] 图片数量是否在4-8张范围内
- [ ] 图片数量与图注数量是否匹配
- [ ] 图片路径是否正确

---

### 10. 文章长度检查

- [ ] 主文档是否在250-300行范围内
- [ ] 是否需要拆分附录

---

### 11. 标题党词汇检查

检查是否包含以下词汇：
- 重塑
- 颠覆
- 革命
- 突破
- 新范式

---

## 输出格式

### 错误（必须修复）

```
❌ 错误（必须修复）:
  ❌ 发现加粗包含标点符号，如 **xxx。**
  ❌ 🚨 发现双backslash公式（高危错误）: $\\xxx$
```

### 警告（建议修复）

```
⚠️ 警告（建议修复）:
  ⚠️ 可能存在未使用\mathrm的微分符号
  ⚠️ 主文档行数偏少（227行），建议250-300行
```

### 通过

```
✅ 所有检查通过！
```

---

## 返回值

- **0**: 无错误（可能有警告）
- **1**: 有错误（必须修复）

---

## 使用示例

### 单个文件检查

```bash
python3 tools/check_blog_quality.py "article.md"
```

### 批量检查

```bash
for file in main.md appendix.md; do
    python3 tools/check_blog_quality.py "$file"
done
```

### CI/CD集成

```bash
# 在提交前自动检查
python3 tools/check_blog_quality.py "article.md"
if [ $? -ne 0 ]; then
    echo "质量检查未通过，请修复错误"
    exit 1
fi
```

---

## 常见问题

### Q1: 工具报告了误报怎么办？

A: 工具可能有假阳性，请手动复查。如果确认是误报，可以忽略该警告。

### Q2: 如何只看错误，不看警告？

A: 工具目前不支持过滤，但错误会以`❌`标记，警告以`⚠️`标记，一目了然。

### Q3: 工具检查不到的内容？

A: 工具无法检查：
- 内容质量（需手动检查）
- 逻辑连贯性（需手动检查）
- 图文融合程度（需手动检查）
- 专业术语准确性（需手动检查）

这些内容请参考`quality/manual_checklist.md`。

---

## 检查顺序

**建议顺序**：
1. 先运行自动化检查
2. 修复所有错误
3. 根据警告决定是否修复
4. 再进行手动检查（参考`manual_checklist.md`）
