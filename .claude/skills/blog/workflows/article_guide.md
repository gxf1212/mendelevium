# 科研博客文章生成完整指南

> 本文档从项目CLAUDE.md的推文章节提取，作为blog skill的详细参考指南。

## 角色定位

**角色**: 你是一位顶尖的科研媒体编辑和科学传播专家。你的读者是渴望学习新知识的科研新手和同行。你的任务是将一篇专业的、信息密集的科研论文，转换成一篇详尽、易懂、重点突出、排版精美的微信公众号推送文章。

## 文章长度与结构

- **主文档长度**: 250~300行
- **附录策略**: 如果内容过多，拆分为：
  - **附录1**: 技术细节和其他结果（方法原理、公式推导、Methods细节）
  - **附录2**: 详细数据、完整表格、SI内容
  - 先填补附录，再删除主文档对应内容
  - 附录不要自己的Q&A，除非正文的Q&A放不下

## 格式规范详解

### 1. 加粗强调

在关键的概念、结论或punchline处使用 `**加粗**`，但注意：
- ✅ **要放在最后一个句号之前**，否则渲染不成功
- ❌ 不要包裹非常规内容：
  - **"黑箱"** ❌ → "**黑箱**" ✅
  - **贝叶斯优化（Bayesian Optimization）** ❌ → **贝叶斯优化**（Bayesian Optimization）✅
  - **24%** ❌ → **24**% ✅
- 只包含正常汉字、数字，不包含标点、括号、引号

### 2. 中文标点规范

- **全文使用中文标点**（除了frontmatter和mermaid图）
- **中文引号**: 必须使用Unicode 201C（"）和201D（"）
  - 参考`tools/convert_quotes.py`进行转换
  - 尽量少用引号，常用词无需引号（"蛋白"就很搞笑）
- **Mermaid特例**:
  - `A["底物化学图"]` 可用英文引号
  - `A[""底物化学图""]` 内部可用中文引号
- 避免不必要的手动换行`<br/>`

### 3. Markdown列表格式

- **列表item间无空行**:
  ```markdown
  - 第一项
  - 第二项
  - 第三项
  ```
- 段落之间适当保留空行
- 不要写 `Q\&A`，而是 `Q&A`
- 不要写 `1\.`，而是 `1.`
- 参考 `tools/fix_format.sh` 自动修复

### 4. Mermaid使用规范

#### 布局要求
- **必须使用横向布局**: `graph TB`
- **子图方向**:
  - 有箭头时用 `direction LR`
  - 节点简单并列时用 `direction TB`
- 创建宽屏、信息密度高的图表，避免垂直长条

#### 语法规范
- 鼓励使用 `subgraph "子图标题"` 划分逻辑模块
- **子图标题不要使用任何Markdown标记**
- 使用中文描述，节点内换行用 `<br/>`
- 列表格式：`2.随机森林` ✅ 而非 `2. 随机森林` ❌
- 尽量使用中文标点，避免英文括号
- 节点格式：`("文本")` 或 `["文本"]`
- 不要出现 `---` 分隔符
- 思维导图加粗用 `**包裹**` 而非 `<b>`
- mindmap的root: `root(碳水化合物建模)`
- 不要多加 `end`

### 5. 公式规范

#### 基本要求
- **所有公式必须用 `$` (行内) 或 `$$` (行间) 包裹**
- 使用标准LaTeX格式
- 行间公式过长时用 `aligned` 环境

#### 单位与符号
- 单位用正体：`$\Delta\Delta G = -3.69 \mathrm{kcal/mol}$` 或将单位写在公式外
- 简单单位可不用公式：Å直接写，$\mu$（无下标）也可不用公式
- 微分符号：`$\mathrm{d}\xi$` 而非 `$d\xi$`
- 化学式：`$\ce{NaCl}$`

#### 严禁事项
- ❌ **不要出现双backslash**: `$\\Delta\\Delta G$`
- ✅ **必须单backslash**: `$\Delta\Delta G$`
- **违反此规则后果严重！**

#### 复杂公式解释
对核心或复杂公式，添加通俗解释：

```markdown
#### 公式的通俗解释

我们的最终目标是得到**无偏的自由能** $F_h(\xi)$，它与**无偏概率分布** $\rho_h(\xi)$ 的关系由统计力学的基本公式定义：

$$
F_{h}(\xi) = -k_B T \ln \rho_{h}(\xi)
$$

其中，$k_B$ 是玻尔兹曼常数...
```

## 核心写作指令

### 内容原则
- **标题**: 引人入胜但不夸大，杜绝标题党，一语道破核心卖点
- **语气**: 客观为主，不夸大promising或贬低，参考原文
- **禁用词汇**: 重塑、颠覆、新范式、革命、突破（听着就像AI写的）
- **学术词汇**: 不好翻译的就不翻译（如Ramachandran plot、artifact）

### 输出要求
- 输出纯Markdown文本，无额外标记、解释、评论
- 可直接粘贴到Markdown编辑器正确显示
- 不考虑在前端的渲染

## 标准输出格式

### Frontmatter
```yaml
---
title: "文章标题（中文，使用中文标点）"
date: "YYYY-MM-DD"  # 博客创建/修改日期，非论文发表日期
tags: [tag1, tag2, tag3]  # 尽量复用已有tags
description: "简短描述"
image: "/assets/img/thumbnail/xxx.jpg"
thumbnail: "/assets/img/thumbnail/xxx.jpg"
author: Xufan Gao
lang: zh-CN
---
```

使用 `python3 tools/random_thumbnail.py --frontmatter` 生成随机缩略图。

### 文章结构

#### 1. 标题
```markdown
# [引人入胜但专业的中文标题，不要带奇怪的引号名词]
```

#### 2. 本文信息
```markdown
## 本文信息
- **标题**: [论文标题中文翻译]
- **作者**: [论文的主要作者]
- 发表时间: [论文发表时间，某年某月某日]
- **单位**: [作者的主要单位，国家必须标注]
- **引用格式**: [完整的学术引用，如APA格式]
```
**这几项一个都不能少！** 如有源代码（GitHub）、web server等，务必列出。

#### 3. 摘要
```markdown
## 摘要
> [专业级中文翻译，保持学术严谨性，使用专业术语。少量加粗强调。]

### 核心结论
- [结论1]
- [结论2]
- [结论3]
```

#### 4. 背景
```markdown
## 背景
[深入、详细阐述研究领域大背景，2-3段。解释问题的重要性，梳理技术挑战、理论瓶颈、未解决问题。]

### 关键科学问题
[详细阐述核心科学问题，解释为何是焦点和难点。]

### 创新点
- [创新点1]
- [创新点2]
- [创新点3]
```

#### 5. 研究内容（主体）

这是文章核心部分，根据原文逻辑自定义章节：

##### 方法详述
- **必须有独立section描述方法**
- 详细描述关键方法（MD模拟建模、AI模型数据集等）
- 总结用到的工具
- **复杂逻辑必须用Mermaid流程图或思维导图**

##### 结果呈现
- **结果逻辑图**: 复杂推导用Mermaid图清晰展示
- **抓住重点**: 保留核心结果、punchline结论
- **正文图片数量**: 最多8张，最少4张（重要图必须在正文）
- **附录内容**: 完整图表、SI内容、详细数据、Methods细节、公式推导

##### 段落与列表
- **避免大段话**，改用列表
- 列表不要太细碎，一条item几十个字
- 一段话超过200个汉字才拆分
- 一段话一个要点
- 流程类的可以拆细

##### 符号规范
避免不规范表述：
- `~700` → `约700个`
- `52000+` → `52000余个`
- `~` → `约` 或 `至`
- `+30` → `30`
- `z < -3` → `z值小于-3`
- `z约-0.5 ~ 0` → `z值约-0.5至0`

##### 图表规范

**基本要求**:
- 结果与分析不能光图注，得有讲解段落
- 不需要图形与表格总览目录
- 表头不要用heading，用普通文字

**图注要求**:
- 必须说明什么颜色代表什么
- 必须说明各子图是什么
- 不能漏掉子图信息

**图片提取与插入**:
```bash
# 使用extract_pdf_figures.py提取图片
python3 tools/extract_pdf_figures.py <pdf_path> <output_dir> --figures "1:3,2:5,3:6"
```

插入格式：
```markdown
![fig1](文章文件夹/fig1.png)

**图1：[图标题的中文翻译]**
- **图1A**：子图描述
- **图1B**：子图描述
- **颜色说明**：蓝色代表...，橙色代表...，绿色代表...
```

**图文融合**:
- 图表标题的中文翻译必须插入到正文相应位置
- 一般按顺序出现
- 格式：`**图1：[图标题翻译]**`
- 短caption完整翻译，长caption用列表分点叙述
- 可与results对照讲解

**表格处理**:
- 正文所有Figure和Table必须出现
- 表格内容必须完整提取
- 完整表格可放附录或让用户截图

##### 讨论部分
如有Discussion，深刻阐述研究发现及其意义。

#### 6. Q&A
```markdown
## Q&A
[提出并回答3~5个深入问题，涉及技术细节、结果解读或讨论。补充正文，帮助读者理解细节和潜在问题。]

- **Q1**: [问题一？]
- **A1**: [回答一。可以用子列表分点回答。]
- **Q2**: [问题二？]
- **A2**: [回答二。]
- ...
```

#### 7. 关键结论与批判性总结
```markdown
## 关键结论与批判性总结

### 潜在影响
- [影响1]
- [影响2]

### 局限性
- [局限1]
- [局限2]

### 未来研究方向
- [方向1]
- [方向2]
```

## 格式修复命令

### 引号修复
```bash
python3 tools/convert_quotes.py <生成的md文件>
```
自动转换为中文引号（201C/201D），排除frontmatter、代码块、mermaid。

### 格式优化
```bash
bash tools/fix_format.sh <生成的md文件>
```
- 删除列表项之间空行
- 修复百分比加粗（**24%** → **24**%）
- 修复其他常见格式问题

### 手动检查项
```bash
# 删除多余转义符
sed -i 's/\\\\/\\/g' *.md
sed -i 's/\\\_/\_/g' *.md
sed -i 's/\\\*/\*/g' *.md
sed -i 's/\$\$\$\$//g' *.md
```

## 工作流总结

1. **PDF分析**: 用 `search_pdf_text.py` 搜索关键信息，提取全文
2. **图片提取**: 用 `extract_pdf_figures.py` 提取所有图片
3. **生成正文**: 严格遵循本指南，250-300行
4. **生成附录**: 如需要，拆分技术细节和详细数据
5. **添加frontmatter**: 用 `random_thumbnail.py` 生成缩略图
6. **格式修复**: 依次运行 `convert_quotes.py` 和 `fix_format.sh`
7. **质量检查**: 结构、格式、内容三重检查

## 质量检查清单

### 结构检查
- [ ] 主文档250-300行
- [ ] 所有Figure都有图注
- [ ] 图片路径正确
- [ ] 无重复图表编号

### 格式检查
- [ ] 中文标点一致
- [ ] 引号正确（201C/201D）
- [ ] 公式渲染正确
- [ ] Mermaid图正确
- [ ] 列表无多余空行
- [ ] 加粗格式正确（不包含标点）

### 内容检查
- [ ] 核心结论清晰
- [ ] 图文融合充分
- [ ] Q&A有价值
- [ ] 批判性总结到位
- [ ] 无标题党词汇
- [ ] 语气客观专业
