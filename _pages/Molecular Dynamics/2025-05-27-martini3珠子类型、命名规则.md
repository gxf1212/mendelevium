---
---
主要参考资料：

- https://doi.org/10.1038/s41592-021-01098-3   Supporting information for: Martini 3: A General Purpose Force Field for Coarse-Grained Molecular Dynamics  
- https://github.com/ricalessandri/Martini3-small-molecules/blob/main/tutorials/building_block_table.pdf
  - https://advanced.onlinelibrary.wiley.com/doi/full/10.1002/adts.202100391
  - https://cgmartini.nl/docs/tutorials/Martini3/Small_Molecule_Parametrization/

# 1. 引言 (Introduction)

Martini 力场是一种广泛应用于生物分子模拟的粗粒化 (Coarse-Grained, CG) 模型 (1)。近年来，经过大幅改进和重新参数化的 Martini 3 版本正式发布 (1)。Martini 3 旨在提供一个通用性更强的 CG 力场，不仅适用于脂质、蛋白质、核酸和糖类等生物大分子体系 (4)，也拓展到了对多种小分子、碳纳米材料以及聚合物的研究 (7)。

相较于早期版本，Martini 3 的核心改进包括更优化的非键相互作用平衡、引入了新的珠子 (bead) 类型（包括不同尺寸和化学特性的珠子）、并增强了对特定相互作用（如氢键和电子极化效应）的描述能力 (1)。这些改进使得 Martini 3 能够更准确地预测分子的堆积模式和相互作用，从而在更广泛的应用领域中提供可靠的模拟结果 (1)。Martini 模型通常采用“四对一”的映射方案，即平均四个重原子及其相连的氢原子被粗粒化为一个相互作用中心（珠子），但对于环状结构等特殊化学基团，也支持更高分辨率的映射 (2)。

本报告旨在详细阐述 Martini 3 力场中珠子的类型、命名方式的传统和原则，并深入探讨其参数化策略和分子映射方法。最后，将通过一个具体的聚合物——聚[2-(N-氧化-N,N-二乙基氨基)甲基丙烯酸乙酯] (poly[2-(N-oxide-N,N-diethylamino)ethyl methacrylate])——的映射实例，展示如何将这些理论知识应用于实践。

# 2. Martini 3 核心珠子 (Bead) 类型与命名传统 (Martini 3 Core Bead Types and Naming Conventions)

Martini 3 模型的基石在于其多样化的珠子类型，这些珠子代表了不同化学性质的分子片段。理解这些珠子的分类、尺寸和命名规则对于正确构建和解读 CG 模型至关重要。

## 2.1 主要珠子类型 (Main Bead Types)

与早期版本类似，Martini 3 保留了基于极性的四种主要珠子类型 (8)：

- **P (Polar)**: 极性珠子，代表强极性基团。
- **N (Non-polar/Intermediate polarity)**: 中等极性或非极性珠子，代表具有一定极性或非极性的基团。
- **C (Apolar/Carbon-like)**: 非极性珠子，通常代表疏水性的烷烃链等。
- **Q (Charged)**: 带电荷珠子，代表离子化的基团。

在 Martini 3 中，这些主要类型得到了扩展和细化，引入了新的专用珠子类型 (8)：

- **W (Water)**: 特定的水珠子，与 Martini 2 中的极性 P4 珠子不同，W 珠子经过独立优化，避免了旧模型中水在室温下结冰等问题。
- **D (Divalent ions)**: 二价离子珠子。
- **X (Halo-compounds)**: 用于描述含卤素原子的基团。

这些主要类型（P, N, C, Q, X）进一步划分为多个亚型，通过数字后缀（通常为1-6）表示其相对极性程度或相互作用强度，数字越大通常表示极性越强或相互作用越强 (10)。Martini 3 将可能的相互作用能级从 Martini 2 的10个扩展到了22个，从而可以更精细地描述不同化学基团间的相互作用差异 (8)。此外，还引入了字母后缀来表征特定的化学特性，如氢键给体/受体能力和电子极化效应 (8)。

## 2.2 珠子尺寸 (Bead Sizes)

Martini 3 引入了三种不同尺寸的珠子，以适应不同分辨率的粗粒化需求，这对于精确描述分子形状和堆积至关重要 (8)：

- **Regular (R)**: 常规尺寸珠子，其 Lennard-Jones (LJ) 参数中的$\sigma$值约为 0.47 nm。设计用于标准的“4对1”映射，即代表4个重原子及其相连的氢原子。
- **Small (S)**: 小尺寸珠子，$\sigma$值约为 0.41 nm。设计用于“3对1”的映射，即代表3个重原子。
- **Tiny (T)**: 微小尺寸珠子，$\sigma$值约为 0.34 nm。设计用于“2对1”的映射，即代表2个重原子。

这三种尺寸的珠子之间的交叉相互作用 (R-S, R-T, S-T) 都经过了专门的参数化，以确保整个力场的平衡性 (8)。小尺寸 (S) 和微小尺寸 (T) 珠子特别适用于描述环状结构（如芳香环和脂肪环）以及其他需要更高分辨率的线性或支链化学基团 (4)。对于完全支化的片段（如季碳原子或叔胺基团），如果片段包含四个非氢原子，通常会使用较小的珠子（如 S 型珠子），因为中心原子的环境暴露程度降低，其对整体相互作用的影响也相应减小 (8)。

## 2.3 命名约定 (Naming Conventions)

Martini 3 珠子的命名遵循一套系统的规则，通常结合了其尺寸、基本化学类型、极性水平以及特殊功能：

- **尺寸前缀**: 
  - **R**: 代表常规尺寸 (Regular)，但在很多情况下，如果珠子名称没有明确的尺寸前缀，则默认为常规尺寸。
  - **S**: 代表小尺寸 (Small)。
  - **T**: 代表微小尺寸 (Tiny)。
- **基本类型字母**: P, N, C, Q, X, W, D，如上所述。
- **极性/相互作用能级**: 通常是一个数字（1到6，对于P, N, C, Q, X 类型），表示相对极性或相互作用强度。例如，P1 表示低极性极性珠子，P6 表示高极性极性珠子 (10)。
- **氢键后缀**: 用于描述珠子的氢键能力 (10)。 
  - **d (donor)**: 表示氢键给体。
  - **a (acceptor)**: 表示氢键受体。
  - **da**: 表示同时具有氢键给体和受体能力。
  - **0 (zero)**: 对于Q类型珠子 (如 Q0)，表示不具有特定的氢键给体或受体能力。对于P和N类型珠子，若无 'd' 或 'a' 后缀，通常意味着其氢键能力不是其主要特征，或作为一般极性珠子处理。
- **电子极化效应后缀**: 主要用于 C 和 X 类型珠子，以模拟邻近化学基团的诱导/共轭效应对分子片段相互作用的影响，并能捕捉优先取向和卤键能力 (8)。 
  - **e (electron-donor/enriched)**: 表示富电子特性。
  - **v (electron-acceptor/vacancy)**: 表示缺电子特性。 例如，萘中心的珠子类型为 TC5e，表示这是一个富电子的微小尺寸非极性珠子。
- **其他特殊后缀**: 
  - **h**: 在某些特定珠子类型中使用，例如在脂质尾链中，C5h 和 C4h 用来区分包含不同数量双键的片段 (12)。
  - **r**: 在某些溶剂模型中出现，如甲醇 (MEOH) 用 SP2r 表示 (13)。

一个典型的 Martini 3 珠子名称组合了这些元素，例如：**SP1d** (小尺寸、极性类型、1级极性、氢键给体)，**TC5e** (微小尺寸、非极性类型、5级相互作用、富电子)。

## 2.4 Martini 3 珠子类型汇总表 (Comprehensive Table of Martini 3 Bead Types)

为了更清晰地展示 Martini 3 中常用珠子的特性，下表总结了部分代表性珠子类型及其关键属性和通常代表的化学片段。此表并非详尽无遗，更完整的列表和特定分子的参数化可以在 Martini 官方网站和相关出版物中找到 (10)。构建新分子模型时，应参考最新的官方 `martini_v3.0.0.itp` 文件和相关文献中的构建模块表 (8)。

| 珠子名称 (Bead Name) | 主要类型 (Main Type) | 尺寸 (Size) | 极性水平 (Polarity Level) | 氢键 (H-bond)  | 其他后缀 (Other Suffix) | 典型化学基团/片段 (Typical Chemical Group/Fragment)          |
| -------------------- | -------------------- | ----------- | ------------------------- | -------------- | ----------------------- | ------------------------------------------------------------ |
| W                    | W                    | R           | N/A                       | N/A            |                         | 水 (代表4个水分子)                                           |
| TW                   | W                    | T           | N/A                       | N/A            |                         | 微小水 (代表2个水分子)，用于受限空间                         |
| C1                   | C                    | R           | 1                         | None           |                         | 饱和烷烃片段 (-CH2-CH2-CH2-CH2-)                             |
| SC3                  | C                    | S           | 3                         | None           |                         | 脂肪环片段 (如环己烷中的 -CH2-CH2-CH2- 单元)，支链烷烃       |
| TC5                  | C                    | T           | 5                         | None           |                         | 芳香环中的 -CH=CH- 片段 (如苯)，共轭体系                     |
| TC5e                 | C                    | T           | 5                         | None           | e                       | 富电子芳香片段 (如萘的中心)                                  |
| P1                   | P                    | R           | 1                         | Donor/Acceptor |                         | 弱极性基团，如醚 (-O-)                                       |
| SP2d                 | P                    | S           | 2                         | Donor          |                         | 中等极性氢键给体，如伯醇 (-CH2OH 中的 OH 部分，若映射为S珠)  |
| TP4a                 | P                    | T           | 4                         | Acceptor       |                         | 强极性氢键受体，如羰基 (C=O，若映射为T珠)                    |
| N0                   | N                    | R           | 0 (特殊)                  | None           |                         | 中性非极性基团，但归类于N，如某些胺的非极性部分              |
| SN1a                 | N                    | S           | 1                         | Acceptor       |                         | 弱中等极性氢键受体，如叔胺 (-N(CH3)-)                        |
| TN4a                 | N                    | T           | 4                         | Acceptor       |                         | 中等极性氢键受体，如醚氧 (-CH2†-O-CH2†-)                     |
| Q0                   | Q                    | R           | 0 (特殊)                  | None           |                         | 带形式电荷但无特定氢键能力的基团，或用于描述电荷离域的离子   |
| SQd                  | Q                    | S           | (level varies)            | Donor          |                         | 带电荷的氢键给体，如质子化的胺基 (-NH3+)                     |
| TQa                  | Q                    | T           | (level varies)            | Acceptor       |                         | 带电荷的氢键受体，如羧酸根 (-COO-)                           |
| X3h                  | X                    | (R/S/T)     | 3                         | None           | h                       | 含卤素化合物，如二氯乙烷中的 -CHCl-CH2Cl (X3h 代表一个氯原子和部分碳链) |

*注：上表仅为示例，具体的珠子类型选择和参数化应参考最新的 Martini 文档和相关研究。极性水平和**氢键**能力可能因具体的化学环境和参数化目标而有所调整。“N/A”表示不适用。*

# 3. Martini 3 珠子参数化策略 (Martini 3 Bead Parametrization Strategy)

Martini 3 珠子的参数化遵循系统性的方法，结合了“自上而下”（top-down，基于实验热力学数据）和“自下而上”（bottom-up，基于全原子模拟数据）的策略，旨在准确再现分子的物理化学性质 (2)。

## 3.1 非键相互作用 (Non-bonded Interactions)

非键相互作用的参数化主要目标是再现小分子在不同溶剂对之间的分配自由能 ($\Delta G_{\text{transfer}}$) (8)。常用的溶剂对包括正十六烷/水、正辛醇/水和氯仿/水等。通过拟合这些分配自由能，可以有效地校准溶质-溶剂以及溶剂-溶剂之间的交叉相互作用强度 (8)。

第二个核心参数化目标是溶剂的互溶性数据，可以通过定性观察或计算混合过剩自由能来进行检验 (8)。互溶性数据同样能够反映不同种类分子间的交叉相互作用以及它们各自的自相互作用的相对强度。

非键相互作用通常采用 Lennard-Jones (LJ) 势来描述：

$$
V_{LJ}(r_{ij}) = 4 \varepsilon_{ij} \left[ \left( \frac{\sigma_{ij}}{r_{ij}} \right)^{12} - \left( \frac{\sigma_{ij}}{r_{ij}} \right)^{6} \right]
$$
其中 rij 是珠子 i 和 j 之间的距离，$\sigma_{ij}$定义了珠子间的有效直径（相互作用为零的点），$\varepsilon_{ij}$定义了势阱深度，代表相互作用强度。对于带电荷的 Q 型和 D 型珠子，除了 LJ 相互作用外，还包含库仑相互作用：
$$
V_C\left(r_{i j}\right)=\frac{1}{4 \pi \varepsilon_0 \varepsilon_r} \frac{q_i q_j}{r_{i j}}
$$


其中$q_i$和$q_j$是珠子的电荷，$ε_0$是真空介电常数，$ε_r$是相对介电常数（在 Martini 中通常设为15，用于隐式地考虑水的屏蔽效应，但具体值可能因模拟体系而异）。

## 3.2 键合相互作用与几何中心映射 (Bonded Interactions and Center-of-Geometry (COG) Mapping)

与主要依赖实验数据的非键参数化不同，键合相互作用（键长、键角、二面角）的参数主要通过“自下而上”的方法获得，即参考全原子 (All-Atom, AA) 模拟得到的结构分布 (16)。

Martini 3 的一个重要改进是采用了基于“几何中心”(Center-of-Geometry, COG) 的映射规则来定义 CG 模型的键合参数，取代了 Martini 2 中常用的“质量中心”(Center of Mass, COM) 映射 (8)。COG 映射在计算分子片段中心时考虑了氢原子的位置，这使得 CG 模型能更好地保持其对应全原子参考结构的体积和形状 (8)。COM 映射有时会导致不满意的键长和过高的堆积密度，而 COG 映射则能产生更接近实际的分子性质（如溶剂可及表面积）和本体性质（如质量密度）(8)。

对于接近全原子分辨率的映射（例如使用 T 型珠子），COG 映射尤为关键。例如，对于4对1映射的烷烃链，COM 和 COG 的差异不大；但对于2对1映射的苯环，两者差异显著 (8)。基于 COG 的键长可以直接从全原子模型中提取，这使得参数化过程更易于自动化。这些初始参数在需要更高精度时可以被进一步优化 (8)。

常用的键合势函数包括：

- **键长 (Bonds)**: 简谐势$V_b(l) = \frac{1}{2} K_b (l - l_0)^2$
- **键角 (Angles)**: 简谐势$V_a(\theta) = \frac{1}{2} K_{\theta} (\theta - \theta_0)^2$
- **二面角** **(Dihedrals)**: 周期性势$V_d(\phi) = K_{\phi} [1 + \cos(n\phi - \phi_0)]$在某些情况下，特别是对于需要保持刚性平面结构或特定构象的分子，也会使用约束 (constraints) 或特殊势函数（如improper二面角）(8)。

# 4. Martini 3 映射方法学 (Martini 3 Mapping Methodology)

将全原子结构映射到粗粒化表示是构建 Martini 模型的首要步骤。Martini 3 提供了一套更一致的规则和指导原则，旨在优化 CG 模型的体积和形状表示。

## 4.1 基本原则 (Basic Principles)

进行原子到珠子的映射时，应遵循以下基本原则 (5)：

1. **原子分组**: 通常将2-4个非氢重原子（及其相连的氢原子）映射为一个 CG 珠子。R、S、T 型珠子分别对应约4、3、2个重原子的映射。
2. **化学基团完整性**: 尽量避免将特定的化学官能团（如酰胺基、羧基、完整的芳香环单元）分割到不同的珠子中，以保持其化学特性。
3. **对称性保留**: 映射方案应尽可能尊重原始分子的对称性。
4. **体积与形状保持**: CG 模型应能较好地再现全原子结构的体积和形状。COG 映射对此有重要贡献。
5. **珠子数量优化**: 珠子的总数应被优化，目标是使每个珠子代表的重原子数与理想映射（如4:1, 3:1, 2:1）的最大偏差控制在每10个重原子中±1个非氢原子的范围内。
6. **原子共享**: 在某些情况下，为了保持底层原子结构的对称性（例如在苯酚、四氢呋喃、甲苯等分子中），一个或多个原子可能被相邻的珠子共享（在一些文献的表格中用 † 标出）(8)。在从 COG 映射的全原子模拟中提取键合参数时，必须考虑到这种共享。

## 4.2 环状结构映射 (Mapping Ring Structures)

环状结构因其特殊的几何形状和电子特性，在 Martini 3 中有特定的映射策略，通常使用 S 型或 T 型珠子 (8)：

- **芳香环** **(Aromatic Rings)**: 芳香环（如苯环、萘环等）通常使用 **T 型珠子**进行描述，以更好地再现其平面性和堆叠行为。 
  - **苯 (Benzene)**: 作为典型的芳香化合物，苯被模型化为三个 TC5 类型的 T 型珠子，每个珠子代表两个连续的碳原子及其相连的氢原子。TC5 是非取代芳香环中 `-C=C-` 基团的首选珠子类型。使用基于 COG 的键长（约 0.29 nm），可以很好地再现苯的液体密度。芳香环模型通常使用约束来连接珠子，因为其键长分布非常窄，需要非常刚性的势函数，这反过来又可能需要较短的模拟时间步长。对于更延展的刚性结构，可以考虑使用虚拟位点。
- **脂肪环 (Aliphatic Rings)**: 脂肪环（如环己烷）通常使用 **S 型珠子**进行描述，以捕捉其相对于芳香环更大的体积感。 
  - **环己烷 (Cyclohexane)**: 作为典型的脂肪环化合物，环己烷通常被描述为一个双 S 珠模型 (SC3-SC3)。SC3 珠子的选择基于分配数据。脂肪环模型通常使用键合相互作用（而非约束）连接，因为它们的键长分布相对较宽。使用约 0.378 nm 的键长，可以很好地再现环己烷的液体密度。

## 4.3 取代基与支链映射 (Mapping Substituents and Branched Chains)

对于带有取代基的环状结构或具有支链的分子，映射时需遵循以下两个主要原则 (8)：

1. 用最少数量的珠子映射所有非氢原子。
2. 尽可能保持分子的对称性、体积和形状，其中芳香环最好用 T 型珠子描述，脂肪环最好用 S 型珠子描述。

例如：

- **甲苯 (Toluene)**: 在苯环上增加一个甲基时，苯环原有的三个 T 型珠子中的一个会变成一个更大的 S 型珠子，以容纳额外的碳原子 (8)。
- **乙苯 (Ethyl-benzene)**: 如果是乙基取代，则会为乙基额外增加一个 T 型珠子（代表乙基的两个碳原子），而苯环部分则可以保持其精确的三个 T 型珠子模型 (8)。
- **支链烷烃/完全支化基团**: 对于如新戊烷（包含5个非氢原子）这样的完全支化基团，通常会使用尺寸较小的珠子。例如，尽管有5个重原子，但由于中心碳原子被包埋，其对环境的暴露减少，因此可以使用一个 S 型珠子来代表整个新戊烷基团，或者根据具体情况进行更细致的划分 (8)。

## 4.4 高级模型设计策略 (Advanced Model Design Strategies)

对于具有多个芳香/脂肪环结构或复杂连接方式的小分子，Martini 3 提供了一些高级模型设计策略，常利用虚拟（相互作用）位点 (virtual sites) 来提高模型的数值稳定性和计算性能 (8)：

- **"铰链"模型 (Hinge Model)**: 适用于刚性的稠合多环化合物，如萘 (Naphthalene)。一个简单的由5个 TC5 珠子通过约束连接的萘模型在凝聚相中可能导致数值不稳定。 "铰链"结构使用4个外部珠子，并将中心的一个或多个珠子描述为虚拟相互作用位点（其位置由构建粒子定义，受力会分配给构建粒子，质量均匀分配给构建粒子）。这种方法减少了约束数量，提高了数值稳定性和模拟速度。通常还会施加一个不当二面角来保持铰链模型的平面性。
- **"分而治之"模型 (Divide and Conquer)**: 适用于由刚性平面片段组成的任意长链，且需要控制片段间的相对二面角，这在小分子和共轭聚合物（如2,2'-联噻吩）中很常见。例如，两个噻吩环各用三个 T 型珠子描述。为了连接它们并控制二面角，可以在每个噻吩环的几何中心使用两个虚拟的非相互作用的哑位点 (dummy sites)，并通过简谐键连接这两个哑位点。然后可以在这些哑位点和每个噻吩环上的两个粒子（如硫原子）之间施加二面角势。
- **"分子转角"模型 (Molecular Turn)**: 用于处理通过 sp2 杂化碳连接的环系统，这种连接方式会产生一个“分子转角”（如某些具有特定扭转行为的分子）。为了保持扭转运动的正确旋转轴，需要特别注意。通常会使用虚拟哑位点：每个环体系的 COG 处各一个，第三个位于连接的 sp2 杂化碳上。通过在这些虚拟位点之间施加简谐键和角势，并辅以适当的二面角势和不当二面角势来维持正确的几何构型和旋转自由度。

这些高级策略体现了 Martini 3 在处理复杂分子结构方面的灵活性和精确性。

# 5. 总结与拓展资源 (Conclusion and Further Resources)

## 5.1 总结 (Summary)

Martini 3 力场通过引入新的珠子类型、更精细的尺寸划分 (R, S, T)、系统的命名规则（包含极性、氢键能力、电子特性等后缀）以及改进的参数化策略（特别是基于几何中心 COG 的映射），显著提升了粗粒化模拟的准确性和适用范围 (1)。其核心优势在于能够在保持较高计算效率的同时，捕捉到关键的化学物理特性，从而能够模拟更大尺度和更长时间尺度的分子过程。

在对新分子（尤其是如本教程中所示的复杂聚合物）进行 Martini 3 映射时，关键步骤包括：

1. 仔细分析全原子化学结构，识别关键官能团。
2. 遵循原子分组（2-4个重原子/珠子）、化学基团完整性、对称性和体积/形状保持等基本映射原则。
3. 参考 Martini 3 珠子类型表和命名规则，为每个分子片段选择最合适的珠子类型和尺寸。
4. 对于缺乏直接预参数化珠子的特殊基团（如本例中的N-氧化物），需基于其化学物理特性（极性、氢键、分配行为等）类比选择最接近的现有珠子，或进行审慎的重新参数化。
5. 定义珠子间的键合连接。

通过这些步骤，可以为目标分子构建合理的 Martini 3 粗粒化模型，为后续的分子动力学模拟打下坚实基础。

## 5.2 拓展资源 (Further Resources)

为了更深入地学习和应用 Martini 3 力场，以下资源非常宝贵：

- **Martini 官方网站**: `http://cgmartini.nl` (2)。这里可以找到最新的力场文件、教程、FAQ 以及已参数化的分子拓扑数据库（包括脂质、蛋白质、糖类、溶剂和小分子等 (8)）。
- **主要出版物**: 
  - Souza, P.C.T., Alessandri, R., Barnoud, J. et al. Martini 3: a general purpose force field for coarse-grained molecular dynamics. *Nat* *Methods* **18**, 382–388 (2021). (1) (Martini 3 的奠基性论文)。
  - Alessandri, R., Souza, P.C.T., Thallmair, S. et al. A coarse-grained force field for small molecules: Martini 3. *ChemRxiv* (2021). (8) (针对小分子参数化的重要参考，包含大量构建模块信息)。
- **模拟软件包**: Martini 力场广泛应用于 GROMACS (4)。NAMD 等其他软件包也有相应的支持或转换工具 (26)。
- **辅助工具**: 
  - `Martinize` (或 `Martinize2`): 用于将全原子蛋白质（以及其他分子）结构转换为 Martini CG 模型的常用脚本 (5)。
  - `Insane.py`: 用于快速搭建复杂膜体系的脚本 (24)。
  - `Polyply`: 用于生成聚合物拓扑的工具 (29)。
  - `MartiniGlass`: 用于 VMD 中可视化 Martini 模型的 Python 包 (23)。
- **力场参数下载**: 
  - Martini 3 核心参数文件 (`martini_v300.zip` 或类似名称) 可从官方网站下载，其中包含了珠子定义 (`.itp` 文件)、相互作用矩阵以及多种已参数化分子的拓扑文件 (14)。
  - 小分子数据库通常托管在 GitHub 等代码仓库中，如 `ricalessandri/Martini3-small-molecules` (8)。
  - Marrink实验室的 GitHub 仓库 (`marrink-lab/martini-forcefields`) 也是获取最新参数和分子拓扑的重要来源 (29)。

利用这些资源，研究者可以有效地将 Martini 3 应用于广泛的化学和生物物理问题研究中，探索复杂体系的结构、动态和热力学性质。