---
title: "短短10微秒就够了？MM/PBSA结合自由能计算的采样陷阱"
date: "2025-11-02"
tags: [mm-pbsa, molecular-dynamics, sampling, convergence, binding-free-energy, enhanced-sampling]
description: "揭示为什么短期分子动力学模拟会给出看似收敛但实际上误导的结合自由能结果，以及如何确保足够的采样"
image: "/assets/img/thumbnail_mine/wh-o3x38m.jpg"
thumbnail: "/assets/img/thumbnail_mine/wh-o3x38m.jpg"
author: Xufan Gao
lang: zh-CN
---

# 短短10微秒就够了？MM/PBSA结合自由能计算的采样陷阱

## 本文信息

- **标题**: Sampling Challenges of MM/PBSA Binding Energy Calculations
- **作者**: Xiaozhe Xu, Fan Zhou, Liangzhen Zheng, Sheng Wang, Daixi Li, Xiangda Peng
- **接收时间**: 2025年10月
- **单位**: 中国上海应用技术大学生物热能科学与技术研究所、上海泽利生物技术公司、中国深圳先进技术研究院
- **引用格式**: Xu, X., Zhou, F., Zheng, L., Wang, S., Li, D., & Peng, X. (2015). Sampling Challenges of MM/PBSA Binding Energy Calculations. *Journal of Physical Chemistry B*, *119*(37), 12071-12079. https://doi.org/10.1021/acs.jpcb.5c04908

## 摘要

> MM/PBSA（分子力学/泊松-玻尔兹曼表面积）是预测蛋白质-配体结合自由能的常用方法。然而，本研究通过对19个蛋白质-配体复合物的系统分析，揭示了一个令人震惊的现象：短期分子动力学（MD）模拟（如100纳秒）会产生看似**收敛但实际上是虚假的**结合自由能值。这些值常常与更长期模拟（如微秒级）的结果不一致，反映出系统中存在缓慢的构象转变被早期模拟所错过。通过PCA分析和增强采样方法（IaMD和OPES），研究证明了**足够的采样**才是获得可靠结合自由能的基础。

### 核心结论

- **虚假收敛陷阱**：短期MD模拟（100 ns）显示的平台期不代表真正的热力学收敛，而是陷入了局部最小值
- **多微秒采样必需**：至少需要3×10微秒的重复模拟才能捕捉蛋白质和配体的关键构象转变
- **增强采样作为补充**：IaMD和OPES可加速采样，但不是万能解决方案，仍需与常规MD相结合
- **配体适应性至关重要**：PCA分析显示许多配体在100 ns内仍未充分探索其可用的构象空间
- **动力学信息丰富**：不同的氢键、π-π相互作用和水桥在不同采样阶段出现和消失，反映出系统的动态本质

**🔍 重要勘误**：原文MM/PBSA采样参数存在计算错误，实际分析的是从10 μs轨迹中每10 ns取一帧的1000帧数据，而非每10 ps取一帧。这不影响核心结论但确保方法学描述准确。

---

## 背景

MM/PBSA已成为**计算蛋白质-配体结合自由能的标准方法**，广泛应用于药物发现、虚拟筛选和结合机制研究。该方法通过分解策略计算结合自由能：

$$\Delta G_{\text{bind}} = \Delta G_{\text{complex}} - \Delta G_{\text{protein}} - \Delta G_{\text{ligand}}$$

其中各项包括范德华相互作用、静电相互作用、极性溶剂化能和非极性溶剂化能等贡献。

然而，在实际应用中，研究者面临一个**关键的但常被忽视的问题**：MD模拟需要多长时间才能获得可靠的结合自由能估计？传统做法通常假设100纳秒到1微秒的模拟是"足够的"，但这一假设很少经过严格的收敛性验证。

实际上，生物大分子系统中存在**多个时间尺度的动力学过程**：

- 纳秒级：侧链和环的局部重排
- 微秒级：二级结构元件的重新定向、结合袋的适应性重塑
- 毫秒及以上：蛋白质的全局构象转变

当我们在这些多尺度变化中进行MM/PBSA计算时，**采样不足导致的偏差**可能远大于其他误差来源（如力场精度、隐溶剂模型近似等）。

## 关键科学问题

本研究旨在回答几个根本性的问题：

1. **100纳秒的MD模拟是否足以获得准确的结合自由能？** 这个时间长度真的代表热力学平衡还是只是一个局部的虚假平台？
2. **什么样的构象变化会影响结合自由能的收敛？** 是配体的旋转、蛋白质结合袋的扩张，还是其他的动力学事件？
3. **增强采样技术（如IaMD和OPES）能否有效加速收敛？** 这些方法的加速因子如何，它们的结果是否可靠？
4. **如何定量评估采样的充分性？** 除了观察能量曲线的平台化，还有哪些指标可以证明系统已达到充分采样？

## 创新点

- **系统性的收敛性研究**：首次在多个代表性蛋白质-配体系统（4个靶点的19个复合物）上系统调查MM/PBSA的采样充分性
- **多层面的分析**：不仅分析全局的结合自由能，还通过PCA、RMSD、氢键统计等深层次方法剖析构象动力学
- **增强采样的比较评估**：详细对比了IaMD和OPES在加速收敛中的性能，并分析了其局限性
- **时间依赖的相互作用分析**：首次系统统计了不同相互作用类型（氢键、π-π、盐桥、水桥）在不同采样时间的占有度变化
- **实践指导**：为用户提供了明确的采样时间建议和质量控制策略

---

## 研究内容

### 研究对象与方法学建立

**四个靶点，19个复合物：**

本研究选择了来自四个重要靶点的代表性蛋白质-配体复合物：

- **PLPRO系列（4个复合物）**：冠状病毒主蛋白酶同源物，代表中等大小的蛋白质和多样化的配体
- **HIF2A系列（5个复合物）**：缺氧诱导因子，蛋白质-蛋白质相互作用的典型代表
- **TNKS2系列（5个复合物）**：PARP家族蛋白，包含锌指结构域
- **cMET系列（5个复合物）**：酪氨酸激酶，代表激酶与小分子配体的相互作用

**MD模拟参数：**

所有模拟使用AMBER 14力场，在NVT系综下进行，温度恒定在298 K。每个系统进行了三条独立的MD轨迹，每条10微秒，总计30微秒的采样。使用2 fs的时间步长，**结构保存间隔为1 ns**（原文：MD snapshots were saved every 1 ns）。

**采样策略详细说明：**
- 总模拟时长：10 μs = 10,000 ns
- 保存间隔：每1 ns保存一帧 → **总共保存10,000帧**
- MM/PBSA分析：从10,000帧中均匀抽取1,000帧 → **相当于每10 ns分析一帧**
- 这样既保证了采样的统计代表性，又避免了过度密集计算带来的计算负担

**MM/PBSA计算：**

⚠️ **重要勘误**：原文中关于MM/PBSA采样参数的描述存在计算错误。根据实际的模拟设置，正确的参数应该是：

从轨迹中均匀抽取1000帧（**每10 ns取一帧**，从每1 ns保存的帧中每10帧取1帧），计算结合自由能及其各个能量分量。为了评估收敛性，使用了**滑动平均**和**累积平均**两种方法：

$$\Delta G_{\text{moving}}(i) = \frac{1}{25}\sum_{j=i-12}^{i+12}\Delta G(j)$$

$$\Delta G_{\text{cumulative}}(n) = \frac{1}{n}\sum_{i=1}^{n}\Delta G(i)$$

其中第一个公式采用25帧（50 ps）的窗口进行滑动平均，第二个公式计算从开始到第n帧的累积平均。

### 核心发现：虚假收敛的揭示

#### 发现1：100纳秒并非真正的收敛点

**图1：不同采样时间下结合自由能的变化**

在最初的100纳秒内，几乎所有系统的结合自由能曲线都显示了明显的平台期——能量值波动在一个狭窄的范围内，标准差通常在3-5 kcal/mol。这个观察结果**直观上支持了"100纳秒足够"的传统观点**。

然而，当延长模拟到1微秒、3微秒乃至10微秒时，情况发生了逆转。许多系统的累积平均开始显示**缓慢的、持续的漂移**：

- **plpro-7sdr**：100 ns时$\Delta G = -32.5 \pm 4.2$ kcal/mol；10 μs时$\Delta G = -35.8 \pm 6.1$ kcal/mol，相差超过3 kcal/mol
- **hif2a-25**：100 ns时稳定在$-24.5 \pm 4.5$ kcal/mol；但到10 μs时，三条轨迹的平均值分别为$-23.8$、$-24.9$、$-26.3$ kcal/mol，显示出显著的**轨迹间差异**
- **cmet-11**：特别极端的例子，早期看似收敛的$-30$ kcal/mol在后期漂移到$-32$ kcal/mol

PCA分析进一步揭示了这背后的原因。以**plpro-7sdr**为例，在前100纳秒内，配体在PCA主成分空间中仅探索了完整可用相空间的约**24%**。到10微秒时，这一比例增加到约**60-70%**。换句话说，系统在早期模拟中被**困在一个局部最小值**中，误以为已经收敛。

#### 发现2：蛋白质和配体的构象适应是长期过程

**图2：受体和配体RMSD随时间的演变**

RMSD（均方根偏差）分析通常被用来评估系统的稳定性。在本研究中：

- **蛋白质RMSD**：大多数系统在前500纳秒内达到平台期，RMSD稳定在2-4 Å，这被广泛认为表示"系统已平衡"
- **配体RMSD**：情况更复杂。虽然总体RMSD可能平稳，但配体内部的**旋转异构体转变**持续发生，特别是在含有灵活侧链或旋转键的配体中

最引人注目的是**结合位点RMSD**（图S7）。虽然全蛋白RMSD平台化，但在结合袋附近的残基（距配体3.5 Å内）表现出**更持久的波动**。这表明配体与蛋白质之间的**相互适应**是一个缓慢的、多步骤的过程：

1. 初期（0-100 ns）：配体对蛋白质结构的撞击和初始调整
2. 中期（100 ns-1 μs）：侧链的二级优化、结合位点微环境的重新组织
3. 晚期（1-10 μs）：更深层的构象选择、隐溶剂效应的充分建立

#### 发现3：关键相互作用的动态出现与消失

为了更深入地理解采样不足的后果，研究者对所有的**氢键、盐桥、π-π相互作用和水桥**进行了统计分析。

**表1（部分）：氢键在不同采样时间的占有度变化**

以**plpro-8eua**系统中的Q267/N-LIG/O5相互作用为例：

| 采样时间 | 氢键占有度 | 能量贡献 |
|---------|---------|--------|
| 100 ns  | 检测不到  | N/A    |
| 1 μs    | 15.3%   | -38.2 kcal/mol |
| 10 μs   | 59.7%   | -42.4 kcal/mol |

这个例子表明，在100纳秒的短模拟中，**某些至关重要的相互作用根本不会出现**，因此被计算所忽视。当这些相互作用在后期突然出现并占有超过50%的时间时，结合自由能的估计会出现显著变化。

类似的模式在多个系统中重复出现。例如在**hif2a-29**中，多个水桥相互作用的占有度在100 ns和10 μs之间变化10倍以上（表S4）。

#### 发现4：PCA空间的不完整探索

PCA（主成分分析）将配体的构象空间投影到前两个主成分上，直观显示采样覆盖率。

**图3：plpro-7sdr系统的PCA分析**

- **100 ns（橙色点）**：配体在PC1-PC2空间中形成一个紧密的云团，覆盖范围有限
- **10 μs（蓝色点）**：分布明显扩展，覆盖的构象空间是100 ns的2-3倍

更定量地，统计表明：

- **plpro-8eua**：100 ns覆盖约43%的10 μs范围
- **hif2a-22**：100 ns覆盖约42%的10 μs范围
- **hif2a-25**：100 ns覆盖约46%的10 μs范围
- **cmet-12**：100 ns覆盖约30%的10 μs范围

这表明，**即使蛋白质RMSD已平台化，配体仍在缓慢地探索新的构象**。

### 增强采样方法的评估

鉴于常规MD存在采样不足的问题，研究者评估了两种增强采样技术：

#### IaMD（加速MD，Accelerated MD）

IaMD通过对势能添加一个非负的"加速"项来加快跨越能量屏障的速度。参数（α、E、M）在表S5中给出。

**图4（对应图S15）：IaMD与常规MD（cMD）的对比**

对于**plpro-7sdr**：

- **cMD**：在10微秒内，累积平均仍在缓慢漂移，三条轨迹间差异显著
- **IaMD 1 μs**：快速达到均衡，但与最终的cMD值偏离约2-3 kcal/mol
- **IaMD 3×10 μs**（重新加权）：与cMD结果更接近，但仍存在一定的系统偏差

关键观察：

- IaMD能加速初始阶段的采样，但**重新加权后的值与无加权的10 μs cMD结果不完全一致**
- 对于某些系统（如**plpro-7sdr**），IaMD在早期会跳过某些重要的配体构象，这些构象只有在标准MD中才能通过缓慢的转变被充分采样
- IaMD最有效的应用是**辅助标准MD的采样**，而非完全替代

#### OPES（Onboarding Potential Energy Surfaces）

OPES是一种更新的增强采样技术，通过实时构建一个修正势来探索配置空间。

**图5（对应图S17）：OPES的收敛特性**

与IaMD相比，OPES在某些系统上表现更好：

- **hif2a-25**：OPES 3×10 μs的结果与cMD 10 μs更加一致
- **tnks2-5**：OPES显示更少的轨迹间变异性

但OPES也有其局限性：

- **计算成本**更高，需要频繁的偏差目标函数计算
- 对于**高维度的配体**（含多个旋转键），OPES仍然难以完全覆盖构象空间
- 某些系统（如**cmet-9**）中，OPES重新加权后的值与标准MD仍有显著偏差

### 能量分量的分层分析

不同的相互作用对结合自由能的贡献并非均匀分布。通过分解分析，研究发现：

**图6：范德华和静电相互作用与结合自由能的相关性**

有趣的发现是，这种相关性在不同系统中变化很大：

- **plpro系列**：静电相互作用（eel）占主导，相关系数可达0.8
- **hif2a系列**：范德华（vdw）与结合自由能的相关性更强
- **cmet系列**：两种相互作用的贡献差异显著

这种差异反映了不同蛋白质-配体相互作用的本质差异。当采样不足时，**某一类型相互作用的缺失会导致严重的偏差**。例如，在plpro系统中，缺失关键的静电相互作用（如多个高占有度的氢键）可能导致结合自由能被高估3-5 kcal/mol。

### 全局约束对采样的影响

为了探索采样限制是否源于全局蛋白质运动还是局部配体动力学，研究者进行了一组对比实验，对蛋白质施加**全局RMSD约束**（固定主链Cα原子）。

**图7（对应图S13）：有无约束MD的对比**

关键发现：

- 施加全局约束**显著加快**了结合自由能的初期收敛
- 100 ns的约束MD与无约束10 μs MD在累积平均上接近
- 这表明**配体在蛋白质灵活运动的背景下学会适应**是一个耗时的过程

这一发现有重要的方法学含义：对于**蛋白质构象灵活性已知的系统**（如激酶的激活环、膜蛋白的胞外环），如果不进行足够长的模拟以允许蛋白质灵活性的充分采样，得到的结合自由能将具有**系统性的偏差**。

---

## 关键发现总结与机制

### 采样不足的三重表现

1. **能量平台的虚假性**：100 ns时看似稳定的能量值实际上是被困在局部最小值中的假象

2. **构象空间的不完整探索**：配体在100 ns内仅探索了完整相空间的20%-50%

3. **相互作用的时间依赖性**：关键的相互作用（氢键、盐桥等）在后期采样阶段才频繁出现

### 蛋白质与配体的多步骤适应机制

基于以上结果，研究者提出了一个**多阶段的结合和适应过程**：

$$\text{阶段I (0-100 ns)} \rightarrow \text{阶段II (100 \text{ ns}-1 \text{ μs})} \rightarrow \text{阶段III (1-10 \text{ μs})} \rightarrow \text{热力学平衡}$$

- **阶段I**：快速的初始吸附，主要由静电相互作用驱动，蛋白质结合位点的初级调整
- **阶段II**：侧链的二级定位，配体旋转异构体的改变，隐溶剂的重新组织
- **阶段III**：稀有的构象转变被采样，多个亚稳态之间的相对稳定性被建立

---

## Q&A

- **Q1: 如果我正在进行药物筛选，是否一定要跑10微秒的MD？这会不会太耗时？**

- **A1**: 这取决于你的具体目标和可用资源。对于**排序（ranking）**任务，相对排序可能对采样长度不如对所有配体使用相同的采样时间敏感。但对于**定量预测绝对结合自由能**，特别是需要准确度在1-2 kcal/mol以内的情况，本研究的数据强烈建议至少3×3-5 μs的采样（3条轨迹×3-5 μs每条）。如果计算资源有限，可以考虑：
  - 使用GPU加速MD（现在可以将10 μs降低到数天甚至数小时的计算时间）
  - 先用100 ns进行初步筛选，对有潜力的候选进行完整的微秒级采样
  - 使用增强采样作为补充（虽然不完全可靠，但能加速初期采样）

- **Q2: 我的系统在100 ns时能量曲线已经完全平坦，为什么我还应该怀疑这是真正的收敛？**

- **A2**: 平坦的能量曲线反映的只是**在某个局部最小值附近的局部收敛**。在分子动力学中，这被称为"假平衡（false equilibrium）"。本研究中的关键证据是PCA分析：即使能量平坦，配体在构象空间中仍在进行缓慢的游走。这种缓慢的构象转变会驱动能量的整体漂移（累积平均的缓慢变化）。建议采用的验证方法包括：
  - 进行多条**独立的**初值轨迹，比较它们的结果是否一致
  - 使用PCA或RMSD进行构象空间的覆盖率分析
  - 追踪关键相互作用（如最强的氢键）的占有度随时间的变化——如果占有度在整个模拟中仍在增加或减少，说明采样不足

- **Q3: 在论文中，IaMD和OPES似乎都不能完全解决问题。我应该如何在实践中选择？**

- **A3**: 这是一个实际的困境。根据本研究和随后的工作，建议的策略是：
  - **黄金标准**：3条独立的1-10 μs常规MD模拟（cMD），这是最可靠但最耗时的方法
  - **平衡方案**：使用IaMD进行10-100 ns的初期加速采样，随后进行200-500 ns的cMD来精细化，总耗时可控制在可接受范围内
  - **快速筛选**：对于大规模筛选，100 ns cMD + IaMD重新加权可作为快速评估，但结果应标记为"初步值"
  - OPES相对较新且计算成本高，除非特别有理由相信它对你的特定系统更合适，否则IaMD+cMD的组合更实用

- **Q4: 不同蛋白质之间的采样需求有差异吗？有没有办法预测某个系统需要多长的采样？**

- **A4**: 是的，存在显著差异。本研究中：
  - **柔性蛋白质**（如激酶、某些HIF2A结构域）需要更长的采样（微秒级）
  - **刚性蛋白质**（某些plpro和tnks2复合物）可能在1-3 μs内较早达到有意义的收敛
  - **配体灵活性**也至关重要：含多个旋转键的配体需要更长的采样

预测性指标包括：
  - 蛋白质的**大小和折叠复杂性**（越大越复杂，一般需要更长采样）
  - 配体的**旋转键数量**（ROTBONDS）
  - 结合位点的**极性和疏水性**比例（混合型位点往往更复杂）

简单的启发式规则：如果蛋白质>400 aa或配体有>6个旋转键，保守估计应该预期需要微秒级采样。

- **Q5: 这篇论文的结论对我现在进行的工作有什么实际影响？我应该改变我的MM/PBSA工作流程吗？**

- **A5**: 绝对应该。主要改进包括：
  1. **报告多条独立轨迹的结果和统计离散度**，而不仅仅报告一个平均值
  2. **明确说明采样长度**（不仅是总长度，还应说明是单条轨迹还是多条）
  3. **进行基本的收敛性检查**：至少绘制累积平均图，观察是否存在长期漂移
  4. **对于高分红的预测**，考虑延长采样到3-5 μs或使用增强采样
  5. **在论文方法部分明确说明采样策略和收敛性验证方式**，这样读者可以评估你的结果的可信度

---

## 关键结论与批判性总结

### 主要贡献

1. **范式转变**：将MM/PBSA从"黑盒方法"转变为一个需要明确采样策略的方法论

2. **定量化的采样需求**：提供了明确的微秒级采样建议，而不是模糊的"足够长"

3. **增强采样的客观评估**：首次系统地展示了IaMD和OPES的优点和局限，设定了对这些方法的现实期望

4. **关键相互作用的时间演化**：详细的氢键、盐桥和水桥分析揭示了结合过程的复杂性

### 局限性与未来方向

**本研究的局限：**

- **样本量有限**：虽然19个复合物是当时较全面的研究，但在现今的语境下仍相对有限
- **力场依赖性**：所有模拟基于AMBER力场；不同力场（CHARMM、OPLS等）的结果可能差异
- **隐溶剂模型**：使用了隐式溶剂（GB）进行MM/PBSA；显式溶剂MD可能需要不同的采样策略
- **温度单一**：所有模拟在298 K进行；热稳定性差的蛋白质可能需要特殊考虑

**需要进一步研究的方向：**

- 发展**采样充分性的定量判据**（目前仍主要依赖主观观察）
- 将机器学习应用于**预测所需采样时间**，基于蛋白质特性
- 探索**GPU加速MD与增强采样的最优组合**
- 研究不同**溶剂模型**下的采样需求差异

### 实践价值评估

- **对当时**（2015年）的影响：这是MM/PBSA采样充分性第一次被系统地、定量地研究，改变了许多研究者的工作习惯
- **对现在**：虽然GPU计算使得微秒级模拟变得更加可行，但结论仍然高度相关。许多用户因为GPU的速度而变得"过度自信"，倾向于用相同的时间跑更多的计算而非更深入地采样
- **对未来**：随着AI辅助分子动力学和自适应采样技术的发展，这个问题可能会被更优雅地解决

### 最后的反思

这篇论文的核心信息是：**看似收敛的结果可能是幻觉**。在计算科学中，这是一个永恒的教训。无论我们使用多么精细的方法、多么快的计算机，如果忽视基本的物理原理——系统需要时间来探索其构象空间——再多的精确度也无法弥补采样不足的根本问题。

从这个角度看，这篇论文不仅为MM/PBSA用户提供了实用指南，更重要的是提醒所有计算生物学研究者：**永远要警惕收敛性的假象**。
